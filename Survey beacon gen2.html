<!DOCTYPE html> 
<html lang="en"> 
<head> 
    <meta charset="UTF-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <title>BeaconGen 2025 - Cadastral Beacon System</title> 
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" 
rel="stylesheet"> 
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" 
rel="stylesheet"> 
    <style> 
        /* Custom CSS for animations and styling */ 
        body { 
            font-family: 'Inter', sans-serif; 
        } 
        .fade-in { 
            animation: fadeIn 0.6s ease-out; 
        } 
        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(30px); } 
            to { opacity: 1; transform: translateY(0); } 
        } 
        .pulse-animation { 
            animation: pulse 2s infinite; 
        } 
        @keyframes pulse { 
            0%, 100% { transform: scale(1); } 
            50% { transform: scale(1.02); } 
        } 
        .gradient-bg { 
            background: linear-gradient(135deg, #1e3a8a 0%, #3730a3 50%, #581c87 100%); 
        } 
        .card-shadow { 
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); 
            transition: all 0.3s ease; 
        } 
        .card-shadow:hover { 
            box-shadow: 0 35px 60px -12px rgba(0, 0, 0, 0.3); 
            transform: translateY(-2px); 
        } 
        .map-container { 
            height: 450px; 
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); 
            border-radius: 12px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            position: relative; 
            overflow: hidden; 
        } 
        .beacon-marker { 
            position: absolute; 
            color: #dc2626; 
            font-size: 24px; 
            animation: bounce 2s infinite; 
            cursor: pointer; 
            transition: all 0.3s ease; 
        } 
        .beacon-marker:hover { 
            transform: scale(1.2); 
            color: #991b1b; 
        } 
        @keyframes bounce { 
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); } 
            40% { transform: translateY(-10px); } 
            60% { transform: translateY(-5px); } 
        } 
        .notification { 
            position: fixed; 
            top: 20px; 
            right: 20px; 
            padding: 16px 24px; 
            border-radius: 12px; 
            color: white; 
            font-weight: 600; 
            z-index: 1000; 
            transform: translateX(100%); 
            transition: transform 0.4s ease; 
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2); 
        } 
        .notification.show { 
            transform: translateX(0); 
        } 
        .notification.success { background: linear-gradient(135deg, #10b981, #059669); } 
        .notification.error { background: linear-gradient(135deg, #ef4444, #dc2626); } 
        .notification.warning { background: linear-gradient(135deg, #f59e0b, #d97706); } 
        .batch-results { 
            max-height: 300px; 
            overflow-y: auto; 
        } 
        .beacon-item { 
            transition: all 0.3s ease; 
            border-radius: 8px; 
            padding: 12px; 
            margin: 8px 0; 
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); 
            border: 1px solid #e2e8f0; 
        } 
        .beacon-item:hover { 
            transform: translateX(8px); 
            background: linear-gradient(135deg, #e0f2fe 0%, #bae6fd 100%); 
            border-color: #0ea5e9; 
        } 
        .file-upload-area { 
            border: 2px dashed #cbd5e1; 
            border-radius: 12px; 
            padding: 32px; 
            text-align: center; 
            transition: all 0.3s ease; 
            cursor: pointer; 
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); 
        } 
        .file-upload-area:hover { 
            border-color: #3b82f6; 
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); 
            transform: translateY(-2px); 
        } 
        .file-upload-area.dragover { 
            border-color: #2563eb; 
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); 
        } 
        .uploaded-file { 
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); 
            border: 2px solid #0ea5e9; 
            border-radius: 8px; 
            padding: 12px; 
            margin-top: 12px; 
            display: flex; 
            align-items: center; 
            justify-content: space-between; 
            transition: all 0.3s ease; 
        } 
        .uploaded-file:hover { 
            transform: translateY(-1px); 
            box-shadow: 0 4px 12px rgba(14, 165, 233, 0.2); 
        } 
        .unique-beacon-display { 
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); 
            color: white; 
            padding: 20px; 
            border-radius: 12px; 
            text-align: center; 
            font-size: 18px; 
            font-weight: bold; 
            margin-bottom: 24px; 
            box-shadow: 0 8px 25px rgba(245, 158, 11, 0.3); 
        } 
        .stats-card { 
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%); 
            border: 1px solid #e2e8f0; 
            transition: all 0.3s ease; 
        } 
        .stats-card:hover { 
            border-color: #3b82f6; 
            transform: translateY(-4px); 
        } 
        .form-input { 
            transition: all 0.3s ease; 
        } 
        .form-input:focus { 
            transform: translateY(-1px); 
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15); 
        } 
        .btn-primary { 
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); 
            transition: all 0.3s ease; 
        } 
        .btn-primary:hover { 
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); 
            transform: translateY(-2px); 
            box-shadow: 0 8px 25px rgba(37, 99, 235, 0.3); 
        } 
        .activity-item { 
            transition: all 0.3s ease; 
            border-radius: 8px; 
            padding: 16px; 
            margin: 8px 0; 
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); 
            border: 1px solid #e2e8f0; 
        } 
        .activity-item:hover { 
            transform: translateX(4px); 
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); 
        } 
        .validation-success { 
            background: linear-gradient(135deg, #10b981 0%, #059669 100%); 
            color: white; 
            padding: 12px; 
            border-radius: 8px; 
            margin: 8px 0; 
        } 
        .validation-error { 
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); 
            color: white; 
            padding: 12px; 
            border-radius: 8px; 
            margin: 8px 0; 
        } 
        .coordinates-display { 
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); 
            color: white; 
            padding: 16px; 
            border-radius: 8px; 
            margin: 12px 0; 
            font-family: monospace; 
        } 
        .quota-warning { 
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); 
            color: white; 
            padding: 12px; 
            border-radius: 8px; 
            text-align: center; 
            margin: 12px 0; 
        } 
        .quota-limit { 
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); 
            color: white; 
            padding: 12px; 
            border-radius: 8px; 
            text-align: center; 
            margin: 12px 0; 
        } 
        footer p { 
            font-family: 'Georgia', serif; 
            font-size: 0.95rem; 
            color: #4b5563; 
        } 
        input[required]::placeholder, 
        select[required] option:first-child, 
        textarea[required]::placeholder { 
            color: #9CA3AF; /* Tailwind's gray-400 */ 
        } 
        input:invalid, 
        select:invalid, 
        textarea:invalid { 
            border-color: #F87171; /* Tailwind's red-400 */ 
        } 
        /* New styles for generatedBeacons display */ 
        .generated-beacons-display-custom { 
            background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); /* Light green to 
medium green */ 
            border: 1px solid #34d399; /* A more vibrant green border */ 
            border-radius: 0.5rem; /* Equivalent to rounded-md */ 
            padding: 1rem; /* Equivalent to p-4 */ 
        } 
        .search-results-card { 
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); 
            border: 1px solid #bfdbfe; 
            border-radius: 0.5rem; 
            padding: 1.5rem; 
            margin-top: 1.5rem; 
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); 
        } 
    </style> 
</head> 
<body class="bg-gray-50 min-h-screen"> 
    <!-- Custom Notification Container --> 
    <div id="notificationContainer" class="notification"></div> 
    <!-- Navigation --> 
    <nav class="gradient-bg text-white shadow-2xl"> 
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"> 
            <div class="flex justify-between items-center h-16"> 
                <div class="flex items-center"> 
                    <i class="fas fa-map-marker-alt text-2xl mr-3"></i> 
                    <span class="text-xl font-bold">BeaconGen 2025</span> 
                    <span class="ml-2 text-sm opacity-75">Edo State Cadastral Beacon 
Management</span> 
                </div> 
                <div class="flex items-center space-x-4"> 
                    <span class="text-sm">Year: <span class="font-bold" id="yearText">2025</
 span></span> 
                    <span class="text-sm">Welcome, <span id="currentUser">Survey Admin</
 span></span> 
                    <button class="bg-white bg-opacity-20 hover:bg-opacity-30 px-3 py-2 
rounded-md transition-all duration-200"> 
                        <i class="fas fa-user"></i> 
                    </button> 
                </div> 
            </div> 
        </div> 
    </nav> 
    <!-- Main Content --> 
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"> 
        <!-- Header Section --> 
        <div class="mb-8 fade-in"> 
            <h1 class="text-3xl font-bold text-gray-900 mb-2">Cadastral Beacon Generation 
System 2025</h1> 
            <p class="text-gray-600">Enhanced cadastral beacon number generation with GIS 
integration for land surveying - Edo State, Nigeria</p> 
        </div> 
        <!-- Year Reset Notice --> 
        <div class="mb-6 p-4 bg-gradient-to-r from-green-500 to-blue-500 text-white rounded
lg card-shadow"> 
            <div class="flex items-center"> 
                <i class="fas fa-refresh mr-3 text-xl"></i> 
                <div id="systemStatusText"> 
                    <!-- Text will be updated by JavaScript --> 
                </div> 
            </div> 
        </div> 
        <!-- Statistics Dashboard --> 
        <div class="grid grid-cols-1 md:grid-cols-5 gap-6 mb-8"> 
            <div class="stats-card p-6 rounded-lg card-shadow fade-in"> 
                <div class="flex items-center justify-between"> 
                    <div> 
                        <p class="text-sm text-gray-600">Beacons Generated (2025)</p> 
                        <p class="text-2xl font-bold text-blue-600" id="totalBeacons">0</p> 
                    </div> 
                    <div class="bg-blue-100 p-3 rounded-full"> 
                        <i class="fas fa-map-pin text-blue-600"></i> 
                    </div> 
                </div> 
            </div> 
            <div class="stats-card p-6 rounded-lg card-shadow fade-in"> 
                <div class="flex items-center justify-between"> 
                    <div> 
                        <p class="text-sm text-gray-600">Active Surveyors</p> 
                        <p class="text-2xl font-bold text-green-600" id="activeSurveyors">18</p> 
                    </div> 
                    <div class="bg-green-100 p-3 rounded-full"> 
                        <i class="fas fa-users text-green-600"></i> 
                    </div> 
                </div> 
            </div> 
            <div class="stats-card p-6 rounded-lg card-shadow fade-in"> 
                <div class="flex items-center justify-between"> 
                    <div> 
                        <p class="text-sm text-gray-600">Parcels Surveyed</p> 
                        <p class="text-2xl font-bold text-purple-600" id="parcelsCount">0</p> 
                    </div> 
                    <div class="bg-purple-100 p-3 rounded-full"> 
                        <i class="fas fa-draw-polygon text-purple-600"></i> 
                    </div> 
                </div> 
            </div> 
            <div class="stats-card p-6 rounded-lg card-shadow fade-in"> 
                <div class="flex items-center justify-between"> 
                    <div> 
                        <p class="text-sm text-gray-600">GIS Coordinates</p> 
                        <p class="text-2xl font-bold text-indigo-600" id="gisPoints">0</p> 
                    </div> 
                    <div class="bg-indigo-100 p-3 rounded-full"> 
                        <i class="fas fa-globe text-indigo-600"></i> 
                    </div> 
                </div> 
            </div> 
            <div class="stats-card p-6 rounded-lg card-shadow fade-in"> 
                <div class="flex items-center justify-between"> 
                    <div> 
                        <p class="text-sm text-gray-600">System Uptime</p> 
                        <p class="text-2xl font-bold text-orange-600">99.9%</p> 
                    </div> 
                    <div class="bg-orange-100 p-3 rounded-full"> 
                        <i class="fas fa-server text-orange-600"></i> 
                    </div> 
                </div> 
            </div> 
        </div> 
        <!-- Main Interface --> 
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8"> 
            <!-- Beacon Generation Panel --> 
            <div class="bg-white rounded-lg card-shadow p-6 fade-in"> 
                <h2 class="text-xl font-bold mb-6 flex items-center"> 
                    <i class="fas fa-plus-circle text-blue-600 mr-2"></i> 
                    Generate Cadastral Beacon Numbers 
                </h2> 
                <!-- Unique Beacon Display --> 
                <div class="unique-beacon-display"> 
                    <i class="fas fa-certificate mr-2"></i> 
                    Unique Beacon ID: <span id="uniqueBeaconId">SC/ED AA0000AZ</span> 
                </div> 
                <form id="beaconForm" class="space-y-4"> 
                    <div> 
                        <label class="block text-sm font-medium text-gray-700 mb-2">Surveyor 
Registration</label> 
                        <select id="surveyorSelect" class="form-input w-full p-3 border border
gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"> 
                            <option value="">Select Surveyor</option> 
                            <!-- Options populated by JavaScript --> 
                        </select> 
                        <div id="surveyorQuota" class="mt-2 text-sm text-gray-600"></div> 
                    </div> 
                    <div> 
                        <label class="block text-sm font-medium text-gray-700 mb-2">Number of 
Beacons</label> 
                        <input type="number" id="beaconCount" min="1" max="50" value="4" 
                            class="form-input w-full p-3 border border-gray-300 rounded-md 
focus:ring-2 focus:ring-blue-500 focus:border-transparent" 
                            placeholder="Enter number of beacons"> 
                        <p class="text-xs text-gray-500 mt-1">Maximum 50 beacons per parcel</p> 
                    </div> 
                    <div> 
                        <label class="block text-sm font-medium text-gray-700 mb-2">Origin 
Beacon Coordinates (Required)</label> 
                        <div class="grid grid-cols-2 gap-4"> 
                            <div> 
                                <label class="block text-xs text-gray-500 mb-1">Latitude</label> 
                                <input type="number" id="latitude" step="0.00001" class="form-input 
w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 
focus:border-transparent" placeholder="6.3350" required> 
                            </div> 
                            <div> 
                                <label class="block text-xs text-gray-500 mb-1">Longitude</label> 
                                <input type="number" id="longitude" step="0.000001" class="form
input w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 
focus:border-transparent" placeholder="5.6037" required> 
                            </div> 
                        </div> 
                        <p class="text-xs text-blue-600 mt-2"> 
                            <i class="fas fa-info-circle mr-1"></i> 
                            Origin coordinates will be recorded for GIS integration. Other beacon 
coordinates will be generated from RECCE diagram. 
                        </p> 
                    </div> 
                    <div> 
                        <label class="block text-sm font-medium text-gray-700 mb-2">Parcel Area 
(Hectares)</label> 
                        <input type="number" id="parcelArea" step="0.01" min="0.01" 
                            class="form-input w-full p-3 border border-gray-300 rounded-md 
focus:ring-2 focus:ring-blue-500 focus:border-transparent" 
                            placeholder="2.5"> 
                        <p class="text-xs text-gray-500 mt-1">Enter the total area of the parcel in 
hectares</p> 
                    </div> 
                    <div> 
                        <label class="block text-sm font-medium text-gray-700 mb-2">Local 
Government Area</label> 
                        <select id="lgaSelect" class="form-input w-full p-3 border border-gray-300 
rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"> 
                            <option value="">Select LGA</option> 
                            <option value="egor">Egor</option> 
                            <option value="oredo">Oredo</option> 
                            <option value="ikpoba-okha">Ikpoba-Okha</option> 
                            <option value="igueben">Igueben</option> 
                            <option value="ovia-north-east">Ovia North-East</option> 
                            <option value="uhunmwonde">Uhunmwonde</option> 
                            <option value="orhionmwon">Orhionmwon</option> 
                            <option value="ovia-south-west">Ovia South West</option> 
                            <option value="esan-central">Esan Central</option> 
                            <option value="esan-south-east">Esan-South-East</option> 
                            <option value="esan-west">Esan-West</option> 
                        </select> 
                    </div> 
                    <div> 
                        <label class="block text-sm font-medium text-gray-700 mb-2">RECCE 
Diagram Upload (Required for GIS)</label> 
                        <div class="file-upload-area" id="fileUploadArea"> 
                            <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-2"></i> 
                            <p class="text-gray-600 mb-2">Click to upload or drag and drop RECCE 
diagram</p> 
                            <p class="text-xs text-gray-500">Required for coordinate generation via 
GIS integration</p> 
                            <p class="text-xs text-gray-500">Supported formats: PDF, JPG, PNG, 
DWG (Max 10MB)</p> 
                            <input type="file" id="recceDiagram" class="hidden" 
accept=".pdf,.jpg,.jpeg,.png,.dwg" multiple> 
                        </div> 
                        <div id="uploadedFiles" class="mt-2"></div> 
                    </div> 
                    <div> 
                        <label class="block text-sm font-medium text-gray-700 mb-2">Parcel 
Description</label> 
                        <textarea id="description" rows="3" class="form-input w-full p-3 border 
border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent" 
                            placeholder="Describe the parcel location and purpose..."></textarea> 
                    </div> 
                    <button type="submit" class="btn-primary w-full text-white py-3 px-6 
rounded-md transition-colors duration-200 pulse-animation"> 
                        <i class="fas fa-magic mr-2"></i>Generate Cadastral Beacon Numbers 
                    </button> 
                </form> 
                <!-- Generated Beacons Display --> 
                <div id="generatedBeacons" class="mt-6 hidden generated-beacons-display
custom"> 
                    <h3 class="font-bold text-green-800 mb-2">Generated Cadastral Beacon 
Numbers:</h3> 
                    <div id="beaconsList" class="batch-results space-y-2"></div> 
                    <div class="coordinates-display"> 
                        <h4 class="font-bold mb-2">GIS Coordinates Recorded:</h4> 
                        <div id="coordinatesList"></div> 
                    </div> 
                    <div class="mt-4 text-sm text-green-700"> 
                        <p><strong>Format:</strong> SC/ED AA0000AZ</p> 
                        <p><strong>Unique ID:</strong> <span id="generatedUniqueId"></span></
 p> 
                        <p><strong>Total Generated:</strong> <span id="totalGenerated">0</
 span></p> 
                        <p><strong>Parcel Area:</strong> <span id="displayParcelArea">0</span> 
hectares</p> 
                        <p><strong>GIS Integration:</strong> <span class="text
blue-600">Coordinates recorded for mapping</span></p> 
                    </div> 
                </div> 
            </div> 
            <!-- Pattern Matching and Validation --> 
            <div class="bg-white rounded-lg card-shadow p-6 fade-in"> 
                <h2 class="text-xl font-bold mb-6 flex items-center"> 
                    <i class="fas fa-search text-purple-600 mr-2"></i> 
                    Pattern Matching & Validation 
                </h2> 
                <div class="space-y-4"> 
                    <div> 
                        <label class="block text-sm font-medium text-gray-700 mb-2">Search/
 Validate Beacon</label> 
                        <div class="relative"> 
                            <input type="text" id="searchBeacon" class="form-input w-full p-3 pl-10 
border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border
transparent" 
                                placeholder="Enter beacon number (e.g., SC/ED AA0001AZ)"> 
                            <i class="fas fa-search absolute left-3 top-3.5 text-gray-400"></i> 
                        </div> 
                    </div> 
                    <button id="validateBtn" class="w-full bg-purple-600 text-white py-3 px-6 
rounded-md hover:bg-purple-700 transition-colors duration-200"> 
                        <i class="fas fa-check-circle mr-2"></i>Validate Beacon 
                    </button> 
                </div> 
                <!-- Validation Results --> 
                <div id="validationResults" class="mt-6 hidden"> 
                    <h3 class="font-bold text-gray-800 mb-3">Validation Results:</h3> 
                    <div id="validationContent" class="space-y-2"></div> 
                </div> 
                <!-- Enhanced Cadastral Guidelines --> 
                <div class="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-md"> 
                    <h3 class="font-bold text-blue-800 mb-2">2025 Cadastral Guidelines</h3> 
                    <div class="text-sm text-blue-700"> 
                        <p><strong>New Requirements:</strong></p> 
                        <ul class="list-disc list-inside mt-1 space-y-1"> 
                            <li>200 beacon limit per surveyor per <strong>quarter</strong></li> 
                            <li>Quota resets every quarter (Jan–Mar, Apr–Jun, Jul–Sep, Oct–Dec)</
 li> 
                            <li>Origin coordinates mandatory for GIS integration</li> 
                            <li>RECCE diagram required for coordinate generation</li> 
                            <li>All beacons must be validated through the system</li> 
                            <li>Minimum 4 beacons per parcel maintained</li> 
                        </ul> 
                    </div> 
                </div> 
                <!-- Surveyor Quota Display --> 
                <div class="mt-4 p-4 bg-orange-50 border border-orange-200 rounded-md"> 
                    <h3 class="font-bold text-orange-800 mb-2">Surveyor Quotas (2025)</h3> 
                    <div class="text-sm text-orange-700"> 
                        <p><strong>Allocation Status:</strong></p> 
                        <ul class="list-disc list-inside mt-1 space-y-1"> 
                            <li>Each surveyor: 200 beacons/year</li> 
                            <li>Quota resets January 1st</li> 
                            <li>System tracks usage automatically</li> 
                        </ul> 
                    </div> 
                </div> 
            </div> 
        </div> 
        <!-- Enhanced Spatial Visualization --> 
        <div class="mt-8 bg-white rounded-lg card-shadow p-6 fade-in"> 
            <h2 class="text-xl font-bold mb-6 flex items-center"> 
                <i class="fas fa-map text-green-600 mr-2"></i> 
                Enhanced GIS Visualization - Edo State 2025 
            </h2> 
            <div class="map-container"> 
                <div class="text-center"> 
                    <i class="fas fa-map-marked-alt text-6xl text-gray-400 mb-4"></i> 
                    <p class="text-gray-600">Interactive Cadastral Map with GIS Integration</p> 
                    <p class="text-sm text-gray-500 mt-2">Real-time coordinate tracking and 
RECCE diagram integration</p> 
                    <div class="mt-4 text-xs text-gray-400"> 
                        <p>Click on beacon markers to view coordinates and details</p> 
                    </div> 
                </div> 
                <!-- Sample beacon markers with coordinates --> 
                <div class="beacon-marker" style="top: 20%; left: 30%;" 
onclick="showBeaconInfo('SC/ED AA0001AZ', '6.3350', '5.6037')"> 
                    <i class="fas fa-map-pin" title="SC/ED AA0001AZ - Origin Point"></i> 
                </div> 
                <div class="beacon-marker" style="top: 40%; left: 60%;" 
onclick="showBeaconInfo('SC/ED AA0002BK', '6.3360', '5.6047')"> 
                    <i class="fas fa-map-pin" title="SC/ED AA0002BK"></i> 
                </div> 
                <div class="beacon-marker" style="top: 60%; left: 25%;" 
onclick="showBeaconInfo('SC/ED AA0003BN', '6.3340', '5.6027')"> 
                    <i class="fas fa-map-pin" title="SC/ED AA0003BN"></i> 
                </div> 
                <div class="beacon-marker" style="top: 35%; left: 70%;" 
onclick="showBeaconInfo('SC/ED AA0004ZG', '6.3370', '5.6057')"> 
                    <i class="fas fa-map-pin" title="SC/ED AA0004ZG"></i> 
                </div> 
            </div> 
        </div> 
        <!-- Enhanced Recent Activity --> 
        <div class="mt-8 bg-white rounded-lg card-shadow p-6 fade-in"> 
            <h2 class="text-xl font-bold mb-6 flex items-center"> 
                <i class="fas fa-clock text-orange-600 mr-2"></i> 
                Recent Beacon Activities 
            </h2> 
            <div id="activityLog" class="batch-results space-y-3"> 
                <!-- Activities will be dynamically added here --> 
                <div class="activity-item flex items-center justify-between text-gray-700"> 
                    <div> 
                        <p class="font-medium">System Initialized for 2025</p> 
                        <p class="text-xs text-gray-500">All quotas reset, new beacon numbering 
started.</p> 
                    </div> 
                    <span class="text-xs text-gray-400">Jan 1, 2025</span> 
                </div> 
            </div> 
        </div> 
        <!-- Surveyor Management Section --> 
        <div class="mt-8 bg-white rounded-lg card-shadow p-6 fade-in"> 
            <h2 class="text-xl font-bold mb-6 flex items-center"> 
                <i class="fas fa-user-tie text-blue-600 mr-2"></i> 
                Surveyor Management 
            </h2> 
            <div class="mb-4"> 
                <label class="block text-sm font-medium text-gray-700 mb-1">Add New 
Surveyor</label> 
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4"> 
                    <input id="newPrefix" class="p-3 border border-gray-300 rounded-md 
focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Prefix (e.g., 
XY)" /> 
                    <input id="newName" class="p-3 border border-gray-300 rounded-md 
focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Surveyor Name" /
 > 
                    <button onclick="addSurveyor()" class="bg-green-600 text-white px-4 py-3 
rounded-md hover:bg-green-700 transition-colors duration-200"> 
                        <i class="fas fa-user-plus mr-1"></i> Add Surveyor 
                    </button> 
                </div> 
            </div> 
            <div class="mt-6"> 
                <button onclick="downloadCurrentQuarterCSV()" class="bg-blue-600 text-white 
px-4 py-3 rounded-md hover:bg-blue-700 mr-2 transition-colors duration-200"> 
                    <i class="fas fa-download mr-1"></i> Download Current Quarter Usage 
                </button> 
                <button onclick="downloadAllQuartersCSV()" class="bg-indigo-600 text-white 
px-4 py-3 rounded-md hover:bg-indigo-700 transition-colors duration-200"> 
                    <i class="fas fa-file-csv mr-1"></i> Download All Quarters Usage 
                </button> 
            </div> 
        </div> 
        <!-- Surveyor Search Section --> 
        <div class="mt-8 bg-white rounded-lg card-shadow p-6 fade-in"> 
            <h2 class="text-xl font-bold mb-6 flex items-center"> 
                <i class="fas fa-user-magnifying-glass text-blue-600 mr-2"></i> 
                Search Surveyor 
            </h2> 
            <div class="mb-4"> 
                <label class="block text-sm font-medium text-gray-700 mb-1">Search by 
Surveyor Name</label> 
                <div class="flex space-x-2"> 
                    <input type="text" id="searchSurveyorName" class="flex-grow p-3 border 
border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent" 
placeholder="Enter surveyor's full name" /> 
                    <button id="searchSurveyorBtn" class="bg-blue-600 text-white px-4 py-3 
rounded-md hover:bg-blue-700 transition-colors duration-200"> 
                        <i class="fas fa-search mr-1"></i> Search 
                    </button> 
                </div> 
            </div> 
            <div id="surveyorSearchResults" class="search-results-card hidden"> 
                <h3 class="font-bold text-gray-800 mb-3">Search Results:</h3> 
                <div id="surveyorDetails"> 
                    <!-- Surveyor details will be displayed here --> 
                </div> 
            </div> 
        </div> 
    </div> 
    <!-- Footer --> 
    <footer class="mt-12 text-center text-gray-600 text-sm py-6"> 
        <hr class="my-6 border-gray-300"> 
        <p> 
            Courtesy Development by <strong>Caesar Oviawe</strong> in collaboration with 
            <strong>Surv. Kceey Ehibor</strong>, <span id="footerYear">2025</span>.<br /> 
            Contact info obtained from <a href="https://www.nisedostate.org" class="text
blue-600 underline hover:text-blue-800" target="_blank">NIS Edo State Website</a> 
        </p> 
    </footer> 
    <script> 
        // Global variables for date and surveyor data 
        const currentDate = new Date(); 
        const currentYear = currentDate.getFullYear(); 
        const currentQuarter = Math.floor(currentDate.getMonth() / 3) + 1; // 1-indexed quarter 
        // Function to format the current date as "Month Day, Year" 
        function getFormattedDate(date) { 
            const options = { year: 'numeric', month: 'long', day: 'numeric' }; 
            return date.toLocaleDateString('en-US', options); 
        } 
        // Update year displays 
        document.getElementById("footerYear").innerText = currentYear; 
        document.getElementById("yearText").innerText = currentYear; 
        // Surveyor data: Prefix to Name mapping 
        const surveyors = { 
            "AZ": "EHIBOR KCEEY", 
            "ZG": "PROF. EHIGIATOR IRUGHE R.", 
            "ZV": "PROF. J.O. EHIOROBO", 
            "AW": "DR. NWODO GEOFFREY", 
            "ZT": "DR. DAVID AWEH", 
            "BA": "VICTOR ITOMO", 
            "BK": "EWERE JUNIOR", 
            "BN": "AUGUSTINE OMOROGIE" 
        }; 
        // Surveyor beacon usage: { "Prefix": { "YYYY-QX": count, ... } } 
        let surveyorBeaconUsage = { 
            "AZ": { "2025-Q1": 10, "2025-Q2": 50, "2025-Q3": 138 }, 
            "ZG": { "2025-Q1": 20, "2025-Q2": 80, "2025-Q3": 192 }, 
            "ZV": { "2025-Q1": 15, "2025-Q2": 70, "2025-Q3": 177 }, 
            "AW": { "2025-Q1": 25, "2025-Q2": 90, "2025-Q3": 193 }, 
            "ZT": { "2025-Q1": 12, "2025-Q2": 45, "2025-Q3": 145 }, 
            "BA": { "2025-Q1": 8, "2025-Q2": 30, "2025-Q3": 126 }, 
            "BK": { "2025-Q1": 18, "2025-Q2": 75, "2025-Q3": 180 }, 
            "BN": { "2025-Q1": 10, "2025-Q2": 40, "2025-Q3": 139 } 
        }; 
        // Global variable to keep track of the last generated serial in "AA0000" format 
        // Initialized to "AA0000" and will be advanced based on historical data. 
        let lastBeaconSerialNum = "AA0000"; 
        // Global Set to store all beacon IDs generated in the current session for validation 
        const generatedBeaconsHistory = new Set(); 
        // Activity log array 
        let activityLog = [ // Changed to 'let' to allow re-initialization if needed 
            { type: 'info', message: 'System Initialized for 2025', timestamp: 'Jan 1, 2025' } 
        ]; 
        // DOM elements 
        const surveyorSelect = document.getElementById("surveyorSelect"); 
        const surveyorQuotaDisplay = document.getElementById("surveyorQuota"); 
        const beaconForm = document.getElementById("beaconForm"); 
        const beaconCountInput = document.getElementById("beaconCount"); 
        const uniqueBeaconIdDisplay = document.getElementById("uniqueBeaconId"); 
        const generatedBeaconsDiv = document.getElementById("generatedBeacons"); 
        const beaconsListDiv = document.getElementById("beaconsList"); 
        const coordinatesListDiv = document.getElementById("coordinatesList"); 
        const totalBeaconsStat = document.getElementById("totalBeacons"); 
        const parcelsCountStat = document.getElementById("parcelsCount"); 
        const gisPointsStat = document.getElementById("gisPoints"); 
        const activityLogDiv = document.getElementById("activityLog"); 
        const searchBeaconInput = document.getElementById("searchBeacon"); 
        const validateBtn = document.getElementById("validateBtn"); 
        const validationResultsDiv = document.getElementById("validationResults"); 
        const validationContentDiv = document.getElementById("validationContent"); 
        const fileUploadArea = document.getElementById('fileUploadArea'); 
        const recceDiagramInput = document.getElementById('recceDiagram'); 
        const uploadedFilesDiv = document.getElementById('uploadedFiles'); 
        const notificationContainer = document.getElementById('notificationContainer'); 
        const systemStatusTextDiv = document.getElementById('systemStatusText'); // New 
DOM element 
        // New DOM elements for Surveyor Search 
        const searchSurveyorNameInput = document.getElementById('searchSurveyorName'); 
        const searchSurveyorBtn = document.getElementById('searchSurveyorBtn'); 
        const surveyorSearchResultsDiv = 
document.getElementById('surveyorSearchResults'); 
        const surveyorDetailsDiv = document.getElementById('surveyorDetails'); 
        /** 
         * Displays a custom notification message. 
         * @param {string} message The message to display. 
         * @param {string} type The type of notification (success, error, warning). 
         */ 
        function showNotification(message, type) { 
            notificationContainer.innerText = message; 
            notificationContainer.className = `notification ${type}`; 
            notificationContainer.classList.add('show'); 
            setTimeout(() => { 
                notificationContainer.classList.remove('show'); 
            }, 3000); // Notification disappears after 3 seconds 
        } 
        /** 
         * Gets the current quarter string (e.g., "2025-Q1"). 
         * @param {Date} date The date object. Defaults to current date. 
         * @returns {string} The quarter string. 
         */ 
        function getQuarterString(date = new Date()) { 
            const year = date.getFullYear(); 
            const quarter = Math.floor(date.getMonth() / 3) + 1; 
            return `${year}-Q${quarter}`; 
        } 
        /** 
         * Loads surveyor options into the dropdown. 
         */ 
        function loadSurveyors() { 
            surveyorSelect.innerHTML = `<option value="">Select Surveyor</option>`; 
            for (const [prefix, name] of Object.entries(surveyors)) { 
                surveyorSelect.innerHTML += `<option value="${prefix}">${name} ($
 {prefix})</option>`; 
            } 
        } 
        /** 
         * Updates the surveyor's beacon quota display. 
         */ 
        function updateQuota() { 
            const prefix = surveyorSelect.value; 
            const beaconButton = beaconForm.querySelector("button[type='submit']"); 
            if (!prefix) { 
                surveyorQuotaDisplay.innerText = ""; 
                if (beaconButton) beaconButton.disabled = false; 
                return; 
            } 
            const quarterKey = getQuarterString(); 
            const usage = surveyorBeaconUsage[prefix] || {}; 
            const usedThisQuarter = usage[quarterKey] || 0; 
            const remainingThisQuarter = 200 - usedThisQuarter; // 200 beacons per quarter 
            surveyorQuotaDisplay.innerText = `${usedThisQuarter} of 200 used in $
 {quarterKey}. Remaining this quarter: ${remainingThisQuarter}`; 
            if (beaconButton) { 
                if (remainingThisQuarter <= 0) { 
                    beaconButton.disabled = true; 
                    showNotification(`Beacon quota reached for ${surveyors[prefix]} (${prefix}) 
in ${quarterKey}. Generation disabled until next quarter.`, 'error'); 
                } else { 
                    beaconButton.disabled = false; 
                } 
            } 
        } 
        /** 
         * Adds a new surveyor to the system. 
         */ 
        function addSurveyor() { 
            const newPrefixInput = document.getElementById("newPrefix"); 
            const newNameInput = document.getElementById("newName"); 
            const prefix = newPrefixInput.value.trim().toUpperCase(); 
            const name = newNameInput.value.trim(); 
            if (!prefix || !name) { 
                showNotification("Please enter both prefix and name for the new surveyor.", 
'warning'); 
                return; 
            } 
            if (surveyors[prefix]) { 
                showNotification(`Surveyor with prefix '${prefix}' already exists.`, 'error'); 
                return; 
            } 
            surveyors[prefix] = name; 
            surveyorBeaconUsage[prefix] = {}; // Initialize usage for new surveyor 
            loadSurveyors(); 
            newPrefixInput.value = ""; 
            newNameInput.value = ""; 
            showNotification(`Surveyor '${name} (${prefix})' added successfully.`, 'success'); 
            addActivity(`New Surveyor Added: ${name} (${prefix})`); 
            calculateAndDisplayTotalStats(); // Update stats after adding surveyor 
        } 
        /** 
         * Downloads a CSV of current quarter beacon usage. 
         */ 
        function downloadCurrentQuarterCSV() { 
            const quarterKey = getQuarterString(); 
            const rows = [["Prefix", "Name", `Beacons Used (${quarterKey})`]]; 
            for (const [prefix, name] of Object.entries(surveyors)) { 
                const used = (surveyorBeaconUsage[prefix] || {})[quarterKey] || 0; 
                rows.push([prefix, name, used]); 
            } 
            const csv = rows.map(r => r.join(",")).join("\n"); 
            const blob = new Blob([csv], { type: 'text/csv' }); 
            const url = URL.createObjectURL(blob); 
            const link = document.createElement("a"); 
            link.href = url; 
            link.download = `beacon_usage_${quarterKey}.csv`; 
            link.click(); 
            URL.revokeObjectURL(url); // Clean up 
            showNotification(`Downloaded beacon usage for ${quarterKey}.`, 'success'); 
        } 
        /** 
         * Downloads a CSV of all quarters beacon usage. 
         */ 
        function downloadAllQuartersCSV() { 
            const rows = [["Prefix", "Name", "Quarter", "Beacons Used"]]; 
            for (const [prefix, name] of Object.entries(surveyors)) { 
                const usage = surveyorBeaconUsage[prefix] || {}; 
                for (const [quarter, used] of Object.entries(usage)) { 
                    rows.push([prefix, name, quarter, used]); 
                } 
            } 
            const csv = rows.map(r => r.join(",")).join("\n"); 
            const blob = new Blob([csv], { type: 'text/csv' }); 
            const url = URL.createObjectURL(blob); 
            const link = document.createElement("a"); 
            link.href = url; 
            link.download = `all_beacon_quarters_usage.csv`; 
            link.click(); 
            URL.revokeObjectURL(url); // Clean up 
            showNotification('Downloaded all quarters beacon usage.', 'success'); 
        } 
        /** 
         * Increments a serial number in AA0000 format. 
         * @param {string} serial The current serial number (e.g., "AA0000"). 
         * @returns {string} The next serial number. 
         */ 
        function incrementSerial(serial) { 
            let alphaPart = serial.substring(0, 2); // e.g., "AA" 
            let numPart = parseInt(serial.substring(2, 6), 10); // e.g., 0, parse as base 10 
            numPart++; // Increment numeric part 
            if (numPart > 9999) { 
                numPart = 0; // Reset numeric part 
                // Increment alphabetic part 
                let char2 = alphaPart.charCodeAt(1); // Second character (e.g., 'A' of "AA") 
                let char1 = alphaPart.charCodeAt(0); // First character (e.g., 'A' of "AA") 
                char2++; // Increment second character 
                if (char2 > 'Z'.charCodeAt(0)) { 
                    char2 = 'A'.charCodeAt(0); // Reset second char to 'A' 
                    char1++; // Increment first character 
                    if (char1 > 'Z'.charCodeAt(0)) { 
                        // This case means it went past ZZ9999. For simplicity, let's wrap it to AA. 
                        // In a real system, this would likely be an error or a new series. 
                        char1 = 'A'.charCodeAt(0); 
                        char2 = 'A'.charCodeAt(0); // Reset both to 'A' 
                    } 
                } 
                alphaPart = String.fromCharCode(char1) + String.fromCharCode(char2); 
            } 
            return alphaPart + String(numPart).padStart(4, '0'); 
        } 
        /** 
         * Generates a unique beacon ID in the SC/ED AA0000AZ format. 
         * Updates the global lastBeaconSerialNum. 
         * @param {string} surveyorPrefix The prefix of the surveyor (e.g., "AZ"). 
         * @returns {string} The generated unique beacon ID. 
         */ 
        function generateFullBeaconId(surveyorPrefix) { 
            lastBeaconSerialNum = incrementSerial(lastBeaconSerialNum); 
            return `SC/ED ${lastBeaconSerialNum}${surveyorPrefix}`; 
        } 
        /** 
         * Adds an activity to the log and displays it. 
         * @param {string} message The activity message. 
         * @param {string} type The type of activity (e.g., 'success', 'info', 'error'). 
         */ 
        function addActivity(message, type = 'info') { 
            const timestamp = new Date().toLocaleString(); 
            activityLog.unshift({ type, message, timestamp }); // Add to the beginning 
            renderActivityLog(); 
        } 
        /** 
         * Renders the activity log in the UI. 
         */ 
        function renderActivityLog() { 
            activityLogDiv.innerHTML = ''; // Clear existing log 
            // Ensure activityLog is an array before proceeding 
            if (!Array.isArray(activityLog)) { 
                console.warn("activityLog was not an array, re-initializing."); 
                activityLog = []; // Re-initialize if it somehow got corrupted 
            } 
            activityLog.slice(0, 10).forEach(activity => { // Show last 10 activities 
                const activityItem = document.createElement('div'); 
                activityItem.className = `activity-item flex items-center justify-between text
gray-700`; 
                activityItem.innerHTML = ` 
                    <div> 
                        <p class="font-medium">${activity.message}</p> 
                        <p class="text-xs text-gray-500">${activity.timestamp}</p> 
                    </div> 
                    <span class="text-xs text-gray-400"></span> 
                `; 
                activityLogDiv.appendChild(activityItem); 
            }); 
        } 
        /** 
         * Calculates and displays total beacons, parcels, and GIS points. 
         * Also initializes lastBeaconSerialNum based on historical data. 
         */ 
        function calculateAndDisplayTotalStats() { 
            let totalBeaconsCount = 0; 
            let totalParcelsCount = 0; // This will be an estimation 
            let totalGisPointsCount = 0; 
            // Sum up historical usage 
            for (const prefix in surveyorBeaconUsage) { 
                for (const quarter in surveyorBeaconUsage[prefix]) { 
                    const beaconsUsed = surveyorBeaconUsage[prefix][quarter]; 
                    totalBeaconsCount += beaconsUsed; 
                    totalParcelsCount += Math.ceil(beaconsUsed / 4); // Assuming 4 beacons per 
parcel 
                    totalGisPointsCount += beaconsUsed; 
                } 
            } 
            // Advance lastBeaconSerialNum based on the total historical count 
            // This ensures new generations continue from a logical point 
            // Only advance if lastBeaconSerialNum is still at its initial "AA0000" 
            // This prevents over-incrementing if calculateAndDisplayTotalStats is called 
multiple times 
            // after initial load. 
            if (lastBeaconSerialNum === "AA0000") { // Only run this part once on initial load 
                for (let i = 0; i < totalBeaconsCount; i++) { 
                    lastBeaconSerialNum = incrementSerial(lastBeaconSerialNum); 
                } 
            } 
            totalBeaconsStat.innerText = totalBeaconsCount; 
            parcelsCountStat.innerText = totalParcelsCount; 
            gisPointsStat.innerText = totalGisPointsCount; 
        } 
        // Event Listeners 
        document.addEventListener("DOMContentLoaded", () => { 
            loadSurveyors(); 
            calculateAndDisplayTotalStats(); // Calculate and display initial stats first 
            updateQuota(); // Initialize quota display (depends on surveyor data) 
            renderActivityLog(); // Display initial activity 
            // Update the system status text with the current date 
            systemStatusTextDiv.innerHTML = ` 
                <p class="font-bold">System Status: Year ${currentYear} - Reset Complete</p> 
                <p class="text-sm opacity-90">Beacon numbering reset to 0000 on 1 January. All 
surveyors have a 200-beacon allocation quarterly for ${currentYear}. (Current Date: $
 {getFormattedDate(currentDate)})</p> 
            `; 
            // Initial update of the unique beacon ID display 
            uniqueBeaconIdDisplay.innerText = `SC/ED ${lastBeaconSerialNum}AZ`; // 
Display initial serial with a placeholder prefix 
        }); 
        surveyorSelect.addEventListener("change", updateQuota); 
        beaconForm.addEventListener("submit", (event) => { 
            event.preventDefault(); // Prevent default form submission 
            const selectedSurveyorPrefix = surveyorSelect.value; 
            const selectedSurveyorName = surveyors[selectedSurveyorPrefix]; // Get surveyor 
name 
            const beaconCount = parseInt(beaconCountInput.value); 
            const latitude = document.getElementById("latitude").value; 
            const longitude = document.getElementById("longitude").value; 
            const parcelArea = document.getElementById("parcelArea").value; 
            const lga = document.getElementById("lgaSelect").value; 
            const description = document.getElementById("description").value; 
            const recceDiagramFiles = recceDiagramInput.files; 
            // Basic validation 
            if (!selectedSurveyorPrefix) { 
                showNotification("Please select a surveyor.", 'warning'); 
                return; 
            } 
            if (isNaN(beaconCount) || beaconCount < 1 || beaconCount > 50) { 
                showNotification("Number of beacons must be between 1 and 50.", 'warning'); 
                return; 
            } 
            if (!latitude || !longitude) { 
                showNotification("Origin Beacon Coordinates (Latitude and Longitude) are 
required.", 'warning'); 
                return; 
            } 
            if (recceDiagramFiles.length === 0) { 
                showNotification("RECCE Diagram Upload is required for GIS integration.", 
'warning'); 
                return; 
            } 
            if (beaconCount < 4) { 
                showNotification("Minimum 4 beacons per parcel is required.", 'warning'); 
                return; 
            } 
            // Check surveyor quota 
            const quarterKey = getQuarterString(); 
            const usedThisQuarter = (surveyorBeaconUsage[selectedSurveyorPrefix] || {})
 [quarterKey] || 0; 
            const remainingThisQuarter = 200 - usedThisQuarter; 
            if (beaconCount > remainingThisQuarter) { 
                showNotification(`Cannot generate ${beaconCount} beacons. Only $
 {remainingThisQuarter} remaining for ${selectedSurveyorName} ($
 {selectedSurveyorPrefix}) in ${quarterKey}.`, 'error'); 
                return; 
            } 
            // Update surveyor usage 
            if (!surveyorBeaconUsage[selectedSurveyorPrefix]) { 
                surveyorBeaconUsage[selectedSurveyorPrefix] = {}; 
            } 
            if (!surveyorBeaconUsage[selectedSurveyorPrefix][quarterKey]) { 
                surveyorBeaconUsage[selectedSurveyorPrefix][quarterKey] = 0; 
            } 
            surveyorBeaconUsage[selectedSurveyorPrefix][quarterKey] += beaconCount; 
            updateQuota(); // Update quota display immediately 
            // Generate beacons 
            beaconsListDiv.innerHTML = ''; // Clear previous results 
            coordinatesListDiv.innerHTML = ''; // Clear previous coordinates 
            let generatedBeacons = []; 
            let generatedCoordinates = []; 
            for (let i = 0; i < beaconCount; i++) { 
                const displayBeacon = generateFullBeaconId(selectedSurveyorPrefix); // Use new 
function 
                generatedBeacons.push(displayBeacon); 
                generatedBeaconsHistory.add(displayBeacon); // Add to history for current 
session validation 
                // For simplicity, other coordinates are just mock values relative to origin 
                const mockLat = (parseFloat(latitude) + (Math.random() * 0.001 - 
0.0005)).toFixed(5); 
                const mockLon = (parseFloat(longitude) + (Math.random() * 0.001 - 
0.0005)).toFixed(6); 
                generatedCoordinates.push({ beacon: displayBeacon, lat: mockLat, lon: mockLon 
}); 
                const beaconItem = document.createElement('div'); 
                beaconItem.className = 'beacon-item flex items-center justify-between text
gray-800'; 
                beaconItem.innerHTML = ` 
                    <span class="font-mono text-blue-700">${displayBeacon}</span> 
                    <i class="fas fa-check-circle text-green-500 ml-2"></i> 
                `; 
                beaconsListDiv.appendChild(beaconItem); 
            } 
            // Display coordinates 
            generatedCoordinates.forEach(coord => { 
                const coordItem = document.createElement('p'); 
                coordItem.className = 'text-sm'; 
                coordItem.innerHTML = `<strong>${coord.beacon}:</strong> Lat ${coord.lat}, 
Lon ${coord.lon}`; 
                coordinatesListDiv.appendChild(coordItem); 
            }); 
            // Update unique beacon ID display 
            document.getElementById("generatedUniqueId").innerText = 
generatedBeacons[0]; // Show first generated ID 
            document.getElementById("totalGenerated").innerText = beaconCount; 
            document.getElementById("displayParcelArea").innerText = parcelArea; 
            generatedBeaconsDiv.classList.remove('hidden'); // Show results section 
            // Update dashboard stats 
            calculateAndDisplayTotalStats(); // Recalculate all stats after generation 
            showNotification(`${beaconCount} beacons generated successfully for $
 {selectedSurveyorName}!`, 'success'); 
            addActivity(`Generated ${beaconCount} beacons for ${selectedSurveyorName} ($
 {selectedSurveyorPrefix})`, 'success'); 
            // Reset form (optional) 
            beaconForm.reset(); 
            surveyorSelect.value = ""; // Reset surveyor select 
            updateQuota(); // Update quota display after reset 
            uploadedFilesDiv.innerHTML = ''; // Clear uploaded files display 
        }); 
        validateBtn.addEventListener("click", () => { 
            const beaconToValidate = searchBeaconInput.value.trim().toUpperCase(); 
            validationContentDiv.innerHTML = ''; // Clear previous results 
            validationResultsDiv.classList.remove('hidden'); 
            if (!beaconToValidate) { 
                validationContentDiv.innerHTML = `<div class="validation-warning">Please 
enter a beacon number to validate.</div>`; 
                showNotification("Please enter a beacon number to validate.", 'warning'); 
                return; 
            } 
            // Updated validation pattern for SC/ED AA0000AZ format 
            // Captures the alphanumeric serial and the surveyor prefix separately 
            const beaconPattern = /^SC\/ED\s([A-Z]{2}\d{4})([A-Z]{2})$/; 
            const match = beaconToValidate.match(beaconPattern); 
            if (match) { 
                const serialAlphaNum = match[1]; // e.g., AA0000 
                const surveyorPrefix = match[2]; // e.g., AZ 
                let isValid = false; 
                let message = ""; 
                // Check if the surveyor prefix exists 
                if (surveyors[surveyorPrefix]) { 
                    // Check if this specific beacon was generated in the current session 
                    if (generatedBeaconsHistory.has(beaconToValidate)) { 
                        isValid = true; 
                        message = `Beacon "${beaconToValidate}" is VALID. Surveyor: $
 {surveyors[surveyorPrefix]} (${surveyorPrefix}). (Generated by system in this session)`; 
                        validationContentDiv.innerHTML = `<div class="validation-success"><i 
class="fas fa-check-circle mr-2"></i>${message}</div>`; 
                        showNotification(`Beacon "${beaconToValidate}" is VALID.`, 'success'); 
                        addActivity(`Validated Beacon: ${beaconToValidate} (Valid, Generated)`, 
'info'); 
                    } else { 
                        // Beacon format and surveyor are correct, but it was not generated in this 
session. 
                        // This implies it's a historical beacon or an invalid one not tracked in current 
session. 
                        message = `Beacon "${beaconToValidate}" is INVALID. Format and 
surveyor correct, but beacon not found in this session's generated history.`; 
                        validationContentDiv.innerHTML = `<div class="validation-error"><i 
class="fas fa-times-circle mr-2"></i>${message}</div>`; 
                        showNotification(`Beacon "${beaconToValidate}" is INVALID.`, 'error'); 
                        addActivity(`Validated Beacon: ${beaconToValidate} (Not Generated in 
Session)`, 'error'); 
                    } 
                } else { 
                    message = `Beacon "${beaconToValidate}" is INVALID. Surveyor prefix '$
 {surveyorPrefix}' not found.`; 
                    validationContentDiv.innerHTML = `<div class="validation-error"><i 
class="fas fa-times-circle mr-2"></i>${message}</div>`; 
                    showNotification(`Beacon "${beaconToValidate}" is INVALID.`, 'error'); 
                    addActivity(`Validated Beacon: ${beaconToValidate} (Invalid Surveyor)`, 
'error'); 
                } 
            } else { 
                const message = `Beacon "${beaconToValidate}" is INVALID. Does not match 
expected format (e.g., SC/ED AA0001AZ).`; 
                validationContentDiv.innerHTML = `<div class="validation-error"><i class="fas 
fa-times-circle mr-2"></i>${message}</div>`; 
                showNotification(`Beacon "${beaconToValidate}" is INVALID.`, 'error'); 
                addActivity(`Validated Beacon: ${beaconToValidate} (Invalid Format)`, 'error'); 
            } 
        }); 
        // File Upload Drag and Drop functionality 
        fileUploadArea.addEventListener('dragover', (e) => { 
            e.preventDefault(); 
            fileUploadArea.classList.add('dragover'); 
        }); 
        fileUploadArea.addEventListener('dragleave', () => { 
            fileUploadArea.classList.remove('dragover'); 
        }); 
        fileUploadArea.addEventListener('drop', (e) => { 
            e.preventDefault(); 
            fileUploadArea.classList.remove('dragover'); 
            recceDiagramInput.files = e.dataTransfer.files; 
            handleFileSelection(); 
        }); 
        fileUploadArea.addEventListener('click', () => { 
            recceDiagramInput.click(); 
        }); 
        recceDiagramInput.addEventListener('change', handleFileSelection); 
        function handleFileSelection() { 
            uploadedFilesDiv.innerHTML = ''; // Clear previous files 
            const files = recceDiagramInput.files; 
            if (files.length > 0) { 
                for (let i = 0; i < files.length; i++) { 
                    const file = files[i]; 
                    const fileItem = document.createElement('div'); 
                    fileItem.className = 'uploaded-file'; 
                    fileItem.innerHTML = ` 
                        <div class="flex items-center"> 
                            <i class="fas fa-file-alt text-blue-500 mr-2"></i> 
                            <span>${file.name} (${(file.size / 1024).toFixed(2)} KB)</span> 
                        </div> 
                        <button type="button" class="text-red-500 hover:text-red-700" 
onclick="removeFile(${i})"> 
                            <i class="fas fa-times-circle"></i> 
                        </button> 
                    `; 
                    uploadedFilesDiv.appendChild(fileItem); 
                } 
                showNotification(`${files.length} file(s) selected.`, 'info'); 
            } 
        } 
        function removeFile(indexToRemove) { 
            // Create a new DataTransfer object 
            const dt = new DataTransfer(); 
            const files = Array.from(recceDiagramInput.files); 
            files.forEach((file, index) => { 
                if (index !== indexToRemove) { 
                    dt.items.add(file); 
                } 
            }); 
            recceDiagramInput.files = dt.files; 
            handleFileSelection(); // Re-render the file list 
            showNotification('File removed.', 'info'); 
        } 
        /** 
         * Dummy function to show beacon info on map marker click. 
         * In a real app, this would open a modal with more more details. 
         */ 
        function showBeaconInfo(beaconId, lat, lon) { 
            showNotification(`Beacon: ${beaconId}, Lat: ${lat}, Lon: ${lon}`, 'info'); 
            addActivity(`Viewed Beacon Info: ${beaconId}`, 'info'); 
        } 
        // Surveyor Search Functionality 
        searchSurveyorBtn.addEventListener('click', () => { 
            const searchTerm = searchSurveyorNameInput.value.trim().toUpperCase(); 
            surveyorDetailsDiv.innerHTML = ''; // Clear previous results 
            surveyorSearchResultsDiv.classList.add('hidden'); 
            if (!searchTerm) { 
                showNotification("Please enter a surveyor name to search.", 'warning'); 
                return; 
            } 
            let foundSurveyor = null; 
            let foundPrefix = null; 
            // Find surveyor by name (case-insensitive search) 
            for (const [prefix, name] of Object.entries(surveyors)) { 
                if (name.toUpperCase().includes(searchTerm)) { 
                    foundSurveyor = name; 
                    foundPrefix = prefix; 
                    break; // Found the first match 
                } 
            } 
            if (foundSurveyor) { 
                let totalBeaconsCollected = 0; 
                const usage = surveyorBeaconUsage[foundPrefix] || {}; 
                for (const quarter in usage) { 
                    totalBeaconsCollected += usage[quarter]; 
                } 
                surveyorDetailsDiv.innerHTML = ` 
                    <p class="text-lg font-semibold text-blue-800">${foundSurveyor}</p> 
                    <p class="text-gray-700"><strong>Prefix:</strong> ${foundPrefix}</p> 
                    <p class="text-gray-700"><strong>Total Beacons Collected (All Quarters):</
 strong> <span class="font-bold text-green-600">${totalBeaconsCollected}</span></p> 
                `; 
                surveyorSearchResultsDiv.classList.remove('hidden'); 
                showNotification(`Surveyor "${foundSurveyor}" found.`, 'success'); 
                addActivity(`Searched for Surveyor: ${foundSurveyor} (${foundPrefix})`, 'info'); 
            } else { 
                surveyorDetailsDiv.innerHTML = `<p class="text-red-600">Surveyor "$
 {searchTerm}" not found.</p>`; 
                surveyorSearchResultsDiv.classList.remove('hidden'); 
                showNotification(`Surveyor "${searchTerm}" not found.`, 'error'); 
                addActivity(`Search for Surveyor: ${searchTerm} (Not Found)`, 'warning'); 
            } 
        }); 
    </script> 
</body> 
</html> 